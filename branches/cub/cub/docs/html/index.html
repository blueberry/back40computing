<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CUB: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CUB
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CUB Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec0">What is CUB?</a></li>
<li class="level1"><a href="#sec1">A simple example</a></li>
<li class="level1"><a href="#sec2">Why do you need CUB?</a></li>
<li class="level1"><a href="#sec3">How does CUB work?</a><ul><li class="level2"><a href="#sec3sec0">Library overview</a></li>
<li class="level2"><a href="#sec3sec1">Reflective type structure</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sec0"></a>
What is CUB?</h1>
<dl class="section user"><dt></dt><dd>CUB is a library of high performance SIMT primitives for CUDA kernel programming. CUB enhances productivity and portability by providing commonplace CTA-wide, warp-wide, and thread-level operations that are flexible and tunable to fit your kernel needs.</dd></dl>
<dl class="section user"><dt></dt><dd>Browse our collections of:<ul>
<li><a href="annotated.html"><b>SIMT cooperative primitives</b></a></li>
<li><a href="group___simt_utils.html"><b>SIMT utilities</b></a></li>
<li><a href="group___host_util.html"><b>Host utilities</b></a></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="sec1"></a>
A simple example</h1>
<dl class="section user"><dt></dt><dd>The following kernel snippet illustrates how easy it is to compose CUB's scan and data-movement primitives into a single kernel for computing prefix sum:</dd></dl>
<dl class="section user"><dt></dt><dd><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cub_8cuh.html">cub.cuh</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// An exclusive prefix sum kernel (assuming only a single CTA)</span></div>
<div class="line"><span class="keyword">template</span> &lt;</div>
<div class="line">     <span class="keywordtype">int</span>         CTA_THREADS,                        <span class="comment">// Threads per CTA</span></div>
<div class="line">     <span class="keywordtype">int</span>         ITEMS_PER_THREAD,                   <span class="comment">// Items per thread</span></div>
<div class="line">     <span class="keyword">typename</span>    T&gt;                                  <span class="comment">// Data type</span></div>
<div class="line">__global__ <span class="keywordtype">void</span> PrefixSumKernel(T *d_in, T *d_out)</div>
<div class="line">{</div>
<div class="line">     <span class="keyword">using namespace </span>cub;</div>
<div class="line"></div>
<div class="line">     <span class="comment">// Declare a parameterized CtaScan type for the given kernel configuration</span></div>
<div class="line">     <span class="keyword">typedef</span> <a class="code" href="classcub_1_1_cta_scan.html" title="The CtaScan type provides variants of parallel prefix scan across threads within a CTA...">CtaScan&lt;T, CTA_THREADS&gt;</a> <a class="code" href="classcub_1_1_cta_scan.html" title="The CtaScan type provides variants of parallel prefix scan across threads within a CTA...">CtaScan</a>;</div>
<div class="line"></div>
<div class="line">     <span class="comment">// The shared memory for CtaScan</span></div>
<div class="line">     __shared__ <span class="keyword">typename</span> <a class="code" href="classcub_1_1_cta_scan.html#a98037d2e1f2390059ef8f7d97493f805" title="The operations exposed by CtaScan require shared memory of this type. This opaque storage can be allo...">CtaScan::SmemStorage</a> smem_storage;</div>
<div class="line"></div>
<div class="line">     <span class="comment">// A segment of data items per thread</span></div>
<div class="line">     T data[ITEMS_PER_THREAD];</div>
<div class="line"></div>
<div class="line">     <span class="comment">// Load a tile of data using vector-load instructions if possible</span></div>
<div class="line">     <a class="code" href="group___simt_utils.html#gaba3b58962601c11d7bc2c0addd08565b" title="Load a tile of items across CTA threads directly using the specified cache modifier.">CtaLoadVectorized</a>(data, d_in, 0);</div>
<div class="line"></div>
<div class="line">     <span class="comment">// Perform an exclusive prefix sum across the tile of data</span></div>
<div class="line">     <a class="code" href="classcub_1_1_cta_scan.html#a5ea28e4ec740677272952997c7793075" title="Computes an exclusive CTA-wide prefix scan using addition (+) as the scan operator. Each thread contributes one input element. Also computes the CTA-wide aggregate of all inputs for thread0.">CtaScan::ExclusiveSum</a>(smem_storage, data, data);</div>
<div class="line"></div>
<div class="line">     <span class="comment">// Store a tile of data using vector-load instructions if possible</span></div>
<div class="line">     <a class="code" href="group___simt_utils.html#ga175a94f15417edb776706412b31dc019" title="Store a tile of items across CTA threads directly using the specified cache modifier.">CtaStoreVectorized</a>(data, d_out, 0);</div>
<div class="line">}</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt></dt><dd>The <a class="el" href="classcub_1_1_cta_scan.html" title="The CtaScan type provides variants of parallel prefix scan across threads within a CTA...">cub::CtaScan</a> primitive implements an efficient prefix sum across CTA threads that is specialized to the underlying architecture. It is parameterized by the number of CTA threads and the aggregate data type <code>T</code>. Once instantiated, it exposes the opaque <a class="el" href="classcub_1_1_cta_scan.html#a98037d2e1f2390059ef8f7d97493f805" title="The operations exposed by CtaScan require shared memory of this type. This opaque storage can be allo...">cub::CtaScan::SmemStorage</a> type which allows us to allocate the shared memory needed by the primitive.</dd></dl>
<dl class="section user"><dt></dt><dd>Furthermore, the kernel uses CUB's primitives for vectorizing global loads and stores. For example, <code>ld.global.v4.s32</code> will be generated when <code>T</code> = <code>int</code> and <code>ITEMS_PER_THREAD</code> is a multiple of 4.</dd></dl>
<h1><a class="anchor" id="sec2"></a>
Why do you need CUB?</h1>
<dl class="section user"><dt></dt><dd>Whereas data-parallelism is easy to implement, cooperative-parallelism is hard. For algorithms requiring local cooperation between threads, the SIMT kernel is the most complex (and performance-sensitive) layer in the CUDA software stack. Developers must carefully manage the state and interaction of many, many threads. Best practices would have us leverage libraries and abstraction layers to help mitigate the complexity, risks, and maintenance costs of this software. However, with the exception of CUB, there are few (if any) software libraries of reusable CTA-level primitives.</dd></dl>
<dl class="section user"><dt></dt><dd>As a SIMT library and software abstraction layer, CUB gives you:<ol type="1">
<li><b>The ease of sequential programming.</b> Parallel primitives within kernels can be simply sequenced together (similar to Thrust programming on the host).</li>
<li><b>The benefits of transparent performance-portability.</b> Kernels can be simply recompiled against new CUB releases (instead of hand-rewritten) to leverage new algorithmic developments, hardware instructions, etc.</li>
</ol>
</dd></dl>
<h1><a class="anchor" id="sec3"></a>
How does CUB work?</h1>
<h2><a class="anchor" id="sec3sec0"></a>
Library overview</h2>
<dl class="section user"><dt></dt><dd>CUDA's SIMT programming model complicates the prospect of software reuse within kernel code. As a SIMT library, CUB must accommodate arbitrary kernel <em>configuration contexts</em>, i.e., specific:<ul>
<li>Data types</li>
<li>Widths of parallelism (CTA threads)</li>
<li>Grain sizes (data items per thread)</li>
<li>Underlying architectures (special instructions, warp width, rules for bank conflicts, etc.)</li>
<li>Tuning requirements (e.g., latency vs. throughput)</li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>To provide this flexibility, CUB is implemented as a C++ template library. C++ templates are a way to write generic algorithms and data structures. There is no need to build CUB separately. You simply #<code>include</code> the appropriate header files into your <code>.cu</code> or <code>.cpp</code> sources and compile with CUDA's <code>nvcc</code> compiler.</dd></dl>
<h2><a class="anchor" id="sec3sec1"></a>
Reflective type structure</h2>
<dl class="section user"><dt></dt><dd>Cooperative SIMT components cannot be constructed and composed like we would traditional procedures and function calls. They require shared memory whose layout for a given primitive will be specific to the details of the calling kernel's <em>configuration context</em> (see above). Furthermore, this shared memory must be allocated externally to the component if it is to be reused elsewhere by the CTA.</dd></dl>
<dl class="section user"><dt></dt><dd>To address this issue, we encapsulate cooperative procedures within reflective type structure (C++ classes). Thus our CUB primitives are C++ classes with interfaces that expose both procedural methods as well as the opaque shared memory types needed for their operation. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 2 2012 04:55:22 for CUB by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
